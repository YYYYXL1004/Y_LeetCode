# å²›å±¿é—®é¢˜ï¼ˆç½‘æ ¼DFSï¼‰

å²›å±¿é—®é¢˜æ˜¯ä¸€ç±»ç»å…¸çš„ç½‘æ ¼éå†é—®é¢˜ï¼Œä½¿ç”¨ DFS/BFS æ¥è§£å†³ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯éå†ç½‘æ ¼ï¼Œé‡åˆ°é™†åœ°å°±è¿›è¡Œæœç´¢ï¼Œå°†ç›¸è¿çš„é™†åœ°æ ‡è®°ä¸ºå·²è®¿é—®ï¼ˆé€šå¸¸æ˜¯"æ²‰æ²¡"ä¸ºæµ·æ°´ï¼‰ã€‚

---

## æ ¸å¿ƒæ¡†æ¶

### DFS æ²‰æ²¡å²›å±¿æ¨¡æ¿

```cpp
// æ–¹å‘æ•°ç»„ï¼šä¸Šä¸‹å·¦å³
vector<vector<int>> dirs = {{-1, 0}, {1, 0}, {0, -1}, {0, 1}};

// DFS æ²‰æ²¡å²›å±¿
void dfs(vector<vector<char>>& grid, int i, int j) {
    int m = grid.size(), n = grid[0].size();
    
    // è¾¹ç•Œæ£€æŸ¥
    if (i < 0 || i >= m || j < 0 || j >= n) return;
    
    // æµ·æ°´æˆ–å·²è®¿é—®
    if (grid[i][j] == '0') return;
    
    // æ²‰æ²¡å½“å‰é™†åœ°
    grid[i][j] = '0';
    
    // é€’å½’æ²‰æ²¡ç›¸é‚»é™†åœ°
    for (auto& d : dirs) {
        dfs(grid, i + d[0], j + d[1]);
    }
}
```

### ä¸»å‡½æ•°æ¡†æ¶

```cpp
int numIslands(vector<vector<char>>& grid) {
    int m = grid.size(), n = grid[0].size();
    int res = 0;
    
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < n; j++) {
            if (grid[i][j] == '1') {  // å‘ç°æ–°å²›å±¿
                res++;
                dfs(grid, i, j);  // æ²‰æ²¡æ•´ä¸ªå²›å±¿
            }
        }
    }
    return res;
}
```

---

## é¢˜ç›®è¯¦è§£

### 1. å²›å±¿æ•°é‡ï¼ˆ200ï¼‰

**æ€è·¯**ï¼šæœ€åŸºç¡€çš„å²›å±¿é—®é¢˜ï¼Œéå†ç½‘æ ¼ï¼Œé‡åˆ°é™†åœ°å°± DFS æ²‰æ²¡å¹¶è®¡æ•°ã€‚

```cpp
class Solution {
public:
    int numIslands(vector<vector<char>>& grid) {
        int res = 0;
        int m = grid.size(), n = grid[0].size();
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid[i][j] == '1') {
                    res++;
                    dfs(grid, i, j);
                }
            }
        }
        return res;
    }
    
    void dfs(vector<vector<char>>& grid, int i, int j) {
        int m = grid.size(), n = grid[0].size();
        if (i < 0 || i >= m || j < 0 || j >= n) return;
        if (grid[i][j] == '0') return;
        
        grid[i][j] = '0';
        dfs(grid, i - 1, j);
        dfs(grid, i + 1, j);
        dfs(grid, i, j - 1);
        dfs(grid, i, j + 1);
    }
};
```

---

### 2. å²›å±¿çš„æœ€å¤§é¢ç§¯ï¼ˆ695ï¼‰

**æ€è·¯**ï¼šDFS è¿”å›æ²‰æ²¡çš„é™†åœ°é¢ç§¯ï¼Œåœ¨ä¸»å‡½æ•°ä¸­å–æœ€å¤§å€¼ã€‚

```cpp
class Solution {
public:
    int maxAreaOfIsland(vector<vector<int>>& grid) {
        int m = grid.size(), n = grid[0].size();
        int res = 0;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid[i][j] == 1) {
                    res = max(res, dfs(grid, i, j));
                }
            }
        }
        return res;
    }
    
    // è¿”å›æ·¹æ²¡çš„é™†åœ°é¢ç§¯
    int dfs(vector<vector<int>>& grid, int i, int j) {
        int m = grid.size(), n = grid[0].size();
        if (i < 0 || i >= m || j < 0 || j >= n) return 0;
        if (grid[i][j] == 0) return 0;
        
        grid[i][j] = 0;
        return 1 + dfs(grid, i - 1, j) + dfs(grid, i + 1, j)
                 + dfs(grid, i, j - 1) + dfs(grid, i, j + 1);
    }
};
```

---

### 3. é£åœ°çš„æ•°é‡ï¼ˆ1020ï¼‰

**é¢˜æ„**ï¼šç»Ÿè®¡ä¸æ¥è§¦è¾¹ç•Œçš„å²›å±¿çš„æ€»é¢ç§¯ã€‚

**æ€è·¯**ï¼š
1. å…ˆ DFS æ·¹æ‰æ‰€æœ‰è¾¹ç•Œä¸Šçš„å²›å±¿ï¼ˆè¿™äº›ä¸æ˜¯é£åœ°ï¼‰
2. å†éå† gridï¼Œç»Ÿè®¡å‰©ä½™å²›å±¿çš„é¢ç§¯

```cpp
class Solution {
public:
    int numEnclaves(vector<vector<int>>& grid) {
        int m = grid.size(), n = grid[0].size();
        
        // æ·¹æ‰å·¦å³è¾¹ç•Œçš„å²›å±¿
        for (int i = 0; i < m; i++) {
            dfs(grid, i, 0);
            dfs(grid, i, n - 1);
        }
        // æ·¹æ‰ä¸Šä¸‹è¾¹ç•Œçš„å²›å±¿
        for (int j = 0; j < n; j++) {
            dfs(grid, 0, j);
            dfs(grid, m - 1, j);
        }
        
        // ç»Ÿè®¡å‰©ä½™å²›å±¿é¢ç§¯
        int res = 0;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid[i][j] == 1) {
                    res += dfs(grid, i, j);
                }
            }
        }
        return res;
    }
    
    int dfs(vector<vector<int>>& grid, int i, int j) {
        int m = grid.size(), n = grid[0].size();
        if (i < 0 || i >= m || j < 0 || j >= n) return 0;
        if (grid[i][j] == 0) return 0;
        
        grid[i][j] = 0;
        return 1 + dfs(grid, i - 1, j) + dfs(grid, i + 1, j)
                 + dfs(grid, i, j - 1) + dfs(grid, i, j + 1);
    }
};
```

---

### 4. ç»Ÿè®¡å°é—­å²›å±¿çš„æ•°ç›®ï¼ˆ1254ï¼‰

**é¢˜æ„**ï¼šç»Ÿè®¡ä¸æ¥è§¦è¾¹ç•Œçš„å²›å±¿æ•°é‡ï¼ˆæ³¨æ„ï¼šæœ¬é¢˜ä¸­ 0 è¡¨ç¤ºé™†åœ°ï¼Œ1 è¡¨ç¤ºæµ·æ°´ï¼‰ã€‚

**æ€è·¯**ï¼š
1. å…ˆ DFS æ·¹æ‰æ‰€æœ‰è¾¹ç•Œä¸Šçš„å²›å±¿
2. å†éå† gridï¼Œç»Ÿè®¡å‰©ä½™å²›å±¿çš„æ•°é‡

```cpp
class Solution {
public:
    int closedIsland(vector<vector<int>>& grid) {
        int m = grid.size(), n = grid[0].size();
        
        // æ·¹æ‰è¾¹ç•Œå²›å±¿
        for (int i = 0; i < m; i++) {
            dfs(grid, i, 0);
            dfs(grid, i, n - 1);
        }
        for (int j = 0; j < n; j++) {
            dfs(grid, 0, j);
            dfs(grid, m - 1, j);
        }
        
        // ç»Ÿè®¡å°é—­å²›å±¿æ•°é‡
        int res = 0;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid[i][j] == 0) {
                    res++;
                    dfs(grid, i, j);
                }
            }
        }
        return res;
    }
    
    void dfs(vector<vector<int>>& grid, int i, int j) {
        int m = grid.size(), n = grid[0].size();
        if (i < 0 || i >= m || j < 0 || j >= n) return;
        if (grid[i][j] == 1) return;
        
        grid[i][j] = 1;
        dfs(grid, i - 1, j);
        dfs(grid, i + 1, j);
        dfs(grid, i, j - 1);
        dfs(grid, i, j + 1);
    }
};
```

---

### 5. ç»Ÿè®¡å­å²›å±¿ï¼ˆ1905ï¼‰

**é¢˜æ„**ï¼šgrid2 ä¸­çš„å²›å±¿å¦‚æœæ¯å—é™†åœ°éƒ½åœ¨ grid1 çš„å¯¹åº”ä½ç½®ä¹Ÿæ˜¯é™†åœ°ï¼Œåˆ™ç§°ä¸ºå­å²›å±¿ã€‚

**å…³é”®è§‚å¯Ÿ**ï¼š
- å¦‚æœ grid2 ä¸­æŸä¸ªä½ç½®æ˜¯é™†åœ°ï¼Œè€Œ grid1 å¯¹åº”ä½ç½®æ˜¯æµ·æ°´
- é‚£ä¹ˆè¿™ä¸ªä½ç½®æ‰€åœ¨çš„å²›å±¿**ä¸€å®šä¸æ˜¯**å­å²›å±¿

**æ€è·¯**ï¼š
1. éå† grid2ï¼Œæ‰¾åˆ° grid1 ä¸ºæµ·ã€grid2 ä¸ºé™†çš„åœ°æ–¹ï¼ŒDFS æ·¹æ‰è¯¥å²›å±¿
2. å‰©ä¸‹çš„å²›å±¿éƒ½æ˜¯å­å²›å±¿ï¼Œç»Ÿè®¡æ•°é‡

```cpp
class Solution {
public:
    int countSubIslands(vector<vector<int>>& grid1, vector<vector<int>>& grid2) {
        int m = grid1.size(), n = grid1[0].size();
        
        // æ·¹æ‰ä¸å¯èƒ½æ˜¯å­å²›çš„å²›å±¿
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid1[i][j] == 0 && grid2[i][j] == 1) {
                    dfs(grid2, i, j);
                }
            }
        }
        
        // ç»Ÿè®¡å‰©ä½™å­å²›å±¿
        int res = 0;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid2[i][j] == 1) {
                    res++;
                    dfs(grid2, i, j);
                }
            }
        }
        return res;
    }
    
    void dfs(vector<vector<int>>& grid, int i, int j) {
        int m = grid.size(), n = grid[0].size();
        if (i < 0 || i >= m || j < 0 || j >= n) return;
        if (grid[i][j] == 0) return;
        
        grid[i][j] = 0;
        dfs(grid, i - 1, j);
        dfs(grid, i + 1, j);
        dfs(grid, i, j - 1);
        dfs(grid, i, j + 1);
    }
};
```

---

### 6. ä¸åŒå²›å±¿çš„æ•°é‡ï¼ˆ694ï¼‰ğŸ”’

**é¢˜æ„**ï¼šè®¡ç®—ç½‘æ ¼ä¸­å½¢çŠ¶ä¸åŒçš„å²›å±¿æ•°é‡ã€‚ä¸¤ä¸ªå²›å±¿ç›¸åŒå½“ä¸”ä»…å½“å¯ä»¥é€šè¿‡å¹³ç§»é‡åˆï¼ˆä¸å…è®¸æ—‹è½¬ã€ç¿»è½¬ï¼‰ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼š
- éœ€è¦è®°å½•å²›å±¿çš„**å½¢çŠ¶ç‰¹å¾**ï¼Œè€Œéä»…ä»…æ˜¯æ•°é‡
- ç”¨ DFS éå†å²›å±¿æ—¶ï¼Œè®°å½•æ¯ä¸ªç‚¹çš„**ç›¸å¯¹åæ ‡**æˆ–**éå†æ–¹å‘åºåˆ—**æ¥å”¯ä¸€æ ‡è¯†å²›å±¿å½¢çŠ¶

**æ–¹æ³•ï¼šæ–¹å‘åºåˆ—ç¼–ç **
- DFS éå†æ—¶è®°å½•ç§»åŠ¨æ–¹å‘ï¼ˆå¦‚ 1=ä¸Š, 2=ä¸‹, 3=å·¦, 4=å³ï¼‰
- åŒæ—¶è®°å½•**ç¦»å¼€èŠ‚ç‚¹**çš„æ–¹å‘ï¼ˆè´Ÿæ•°ï¼‰ï¼Œå½¢æˆå”¯ä¸€çš„éå†è·¯å¾„
- ç”¨ `set` å»é‡ï¼Œç»Ÿè®¡ä¸åŒå½¢çŠ¶çš„æ•°é‡

```cpp
class Solution {
public:
    int numDistinctIslands(vector<vector<int>>& grid) {
        int m = grid.size(), n = grid[0].size();
        // è®°å½•æ‰€æœ‰å²›å±¿çš„åºåˆ—åŒ–ç»“æœ
        unordered_set<string> islands;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid[i][j] == 1) {
                    // æ·¹æ‰è¿™ä¸ªå²›å±¿ï¼ŒåŒæ—¶å­˜å‚¨å²›å±¿çš„åºåˆ—åŒ–ç»“æœ
                    string sb;
                    // åˆå§‹çš„æ–¹å‘å¯ä»¥éšä¾¿å†™ï¼Œä¸å½±å“æ­£ç¡®æ€§
                    dfs(grid, i, j, sb, 666);
                    islands.insert(sb); 
                }
            }
        }
        // ä¸ç›¸åŒçš„å²›å±¿æ•°é‡
        return islands.size();
    }

private:
    void dfs(vector<vector<int>>& grid, int i, int j, string& sb, int dir) {
        int m = grid.size(), n = grid[0].size();
        if (i < 0 || j < 0 || i >= m || j >= n || grid[i][j] == 0) {
            return;
        }
        // å‰åºéå†ä½ç½®ï¼šè¿›å…¥ (i, j)
        grid[i][j] = 0;
        sb += to_string(dir) + ',';
        
        dfs(grid, i - 1, j, sb, 1);
        dfs(grid, i + 1, j, sb, 2);
        dfs(grid, i, j - 1, sb, 3);
        dfs(grid, i, j + 1, sb, 4);
        
        // ååºéå†ä½ç½®ï¼šç¦»å¼€ (i, j)
        sb += to_string(-dir) + ',';
    }
};

```

---

## æ ¸å¿ƒæŠ€å·§æ€»ç»“

### 1. æ²‰æ²¡å²›å±¿ï¼ˆæŸ“è‰²æ³•ï¼‰

é€šè¿‡å°†è®¿é—®è¿‡çš„é™†åœ°ç›´æ¥ä¿®æ”¹ä¸ºæµ·æ°´ï¼ˆæˆ–ç‰¹æ®Šæ ‡è®°ï¼‰ï¼Œé¿å…ä½¿ç”¨é¢å¤–çš„ `visited` æ•°ç»„ï¼š
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(1) é¢å¤–ç©ºé—´ï¼ˆä¸è€ƒè™‘é€’å½’æ ˆï¼‰
- **æ³¨æ„**ï¼šè¿™ä¼šä¿®æ”¹è¾“å…¥æ•°æ®ï¼Œå¦‚æœéœ€è¦ä¿ç•™åŸæ•°æ®è¦å…ˆå¤åˆ¶

### 2. è¾¹ç•Œå¤„ç†æŠ€å·§

å¯¹äº"ä¸æ¥è§¦è¾¹ç•Œçš„å²›å±¿"ç±»é—®é¢˜ï¼Œé€šç”¨å¥—è·¯æ˜¯ï¼š
1. å…ˆ DFS æ·¹æ‰æ‰€æœ‰**è¾¹ç•Œä¸Š**çš„å²›å±¿
2. å†éå†æ•´ä¸ª gridï¼Œç»Ÿè®¡**å‰©ä½™**çš„å²›å±¿

### 3. å¤šç½‘æ ¼é—®é¢˜

å½“æ¶‰åŠä¸¤ä¸ª gridï¼ˆå¦‚å­å²›å±¿é—®é¢˜ï¼‰ï¼š
- å…ˆæ ¹æ®æ¡ä»¶åœ¨ä¸€ä¸ª grid ä¸­æ’é™¤ä¸ç¬¦åˆçš„å²›å±¿
- å†ç»Ÿè®¡å¦ä¸€ä¸ª grid ä¸­å‰©ä½™çš„å²›å±¿

### 4. DFS è¿”å›å€¼è®¾è®¡

- **åªç»Ÿè®¡æ•°é‡**ï¼šDFS è¿”å› `void`ï¼Œåœ¨ä¸»å‡½æ•°ä¸­è®¡æ•°
- **éœ€è¦é¢ç§¯**ï¼šDFS è¿”å› `int`ï¼Œç´¯åŠ é¢ç§¯

---

## å¤æ‚åº¦åˆ†æ

| å¤æ‚åº¦ | åˆ†æ |
|--------|------|
| æ—¶é—´ | O(m Ã— n)ï¼Œæ¯ä¸ªæ ¼å­æœ€å¤šè¢«è®¿é—®ä¸€æ¬¡ |
| ç©ºé—´ | O(m Ã— n)ï¼Œé€’å½’æ ˆæ·±åº¦æœ€åæƒ…å†µï¼ˆæ•´ä¸ªgridéƒ½æ˜¯é™†åœ°ï¼‰|

---

## ç›¸å…³é¢˜ç›®

| é¢˜å· | é¢˜ç›® | éš¾åº¦ | ç±»å‹ |
|------|------|------|------|
| 200 | å²›å±¿æ•°é‡ | ä¸­ç­‰ | åŸºç¡€ |
| 695 | å²›å±¿çš„æœ€å¤§é¢ç§¯ | ä¸­ç­‰ | åŸºç¡€ |
| 1020 | é£åœ°çš„æ•°é‡ | ä¸­ç­‰ | è¾¹ç•Œå¤„ç† |
| 1254 | ç»Ÿè®¡å°é—­å²›å±¿çš„æ•°ç›® | ä¸­ç­‰ | è¾¹ç•Œå¤„ç† |
| 694 | ä¸åŒå²›å±¿çš„æ•°é‡ | ä¸­ç­‰ | å½¢çŠ¶ç¼–ç ï¼ˆä¼šå‘˜é¢˜ï¼‰ |
| 1905 | ç»Ÿè®¡å­å²›å±¿ | ä¸­ç­‰ | åŒç½‘æ ¼ |
